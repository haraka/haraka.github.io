{"_path":"/plugins/connect.p0f","_dir":"plugins","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"connect.p0f - TCP Fingerprinting plugin for Haraka","description":"Haraka connect.p0f plugin - TCP Fingerprinting","navigation":{"title":"connect.p0f"},"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"connectp0f-plugin"},"children":[{"type":"text","value":"connect.p0f plugin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Use TCP fingerprint info (remote computer OS, network distance, etc) to\nimplement more sophisticated anti-spam policies."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plugin inserts a "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"p0f"}]},{"type":"text","value":" connection note with information deduced\nfrom the TCP fingerprint. The note typically includes at least the link,\ndetail, distance, uptime, genre. Here's an example:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"genre    => FreeBSD\ndetail   => 8.x (1)\nuptime   => 1390\nlink     => ethernet/modem\ndistance => 17"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Which was parsed from this p0f fingerprint:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"24.18.227.2:39435 - FreeBSD 8.x (1) (up: 1390 hrs)\n-> 208.75.177.101:25 (distance 17, link: ethernet/modem)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The following additional values may also be available in\nthe "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"p0f"}]},{"type":"text","value":" connection note:"}]},{"type":"element","tag":"code","props":{"code":"magic, status, first_seen, last_seen, total_conn, uptime_min, up_mod_days, last_nat, last_chg, distance, bad_sw, os_match_q, os_name, os_flavor, http_name, http_flavor, link_type, and language.\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"magic, status, first_seen, last_seen, total_conn, uptime_min, up_mod_days, last_nat, last_chg, distance, bad_sw, os_match_q, os_name, os_flavor, http_name, http_flavor, link_type, and language."}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"configuration"},"children":[{"type":"text","value":"Configuration"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"start p0f"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Create a startup script for p0f that creates a communication socket when your\nserver starts up."}]},{"type":"element","tag":"code","props":{"code":"/usr/local/bin/p0f -u smtpd -d -s /tmp/.p0f_socket 'dst port 25 or dst port 587'\nchown smtpd /tmp/.p0f_socket\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"/usr/local/bin/p0f -u smtpd -d -s /tmp/.p0f_socket 'dst port 25 or dst port 587'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"chown smtpd /tmp/.p0f_socket"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"2. configure p0f plugin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"add an entry to config/plugins to enable p0f:"}]},{"type":"element","tag":"code","props":{"code":"connect.p0f\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"connect.p0f"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"3. review settings in config/connect.p0f.ini"}]},{"type":"element","tag":"h2","props":{"id":"startup"},"children":[{"type":"text","value":"Startup"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the contrib/ubuntu-upstart directory is a config file (p0f.conf) for Ubuntu."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the contrib/bsd-rc.d directory is a startup file for FreeBSD."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"configuration","depth":2,"text":"Configuration"},{"id":"startup","depth":2,"text":"Startup"}]}},"_type":"markdown","_id":"content:8.plugins:connect.p0f.md","_source":"content","_file":"8.plugins/connect.p0f.md","_extension":"md"}