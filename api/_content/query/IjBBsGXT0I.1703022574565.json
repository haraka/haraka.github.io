{"_path":"/plugins/data.uribl","_dir":"plugins","_draft":false,"_partial":false,"_locale":"","title":"data.uribl - URI Blacklists plugin for Haraka","description":"Haraka data.uribl plugin - URI Blacklists","navigation":{"title":"data.uribl"},"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"datauribl-plugin"},"children":[{"type":"text","value":"data.uribl plugin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plugin extracts URIs and feeds them to RHS based blacklists such as\n"},{"type":"element","tag":"a","props":{"href":"http://www.spamhaus.org/dbl","rel":["nofollow"]},"children":[{"type":"text","value":"DBL"}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"http://spameatingmonkey.com/lists.html#SEM-FRESH","rel":["nofollow"]},"children":[{"type":"text","value":"SEM-FRESH"}]},{"type":"text","value":" and body URI based DNS blacklists such as\n"},{"type":"element","tag":"a","props":{"href":"http://www.surbl.org/","rel":["nofollow"]},"children":[{"type":"text","value":"SURBL"}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"http://www.uribl.com/","rel":["nofollow"]},"children":[{"type":"text","value":"URIBL"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plugin will discard any domain name that does not have a valid TLD\nor any IP address within RFC1918, 127/8 or 169.254/16 (APIPA) and will\nconvert any URI ending in in-addr.arpa into an IP address lookup."}]},{"type":"element","tag":"h2","props":{"id":"configuration"},"children":[{"type":"text","value":"Configuration"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plugin reads configuration from data.uribl.ini."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The main section defines global settings for all lists and the blacklists\nzones are specified as INI section headings with the configuration for\neach zone within that section."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The main section can contain the following options:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"timeout"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Default: 30"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"The total timeout in seconds for each group of lookups.  Any group of\nlookups that takes longer than this will be aborted and the session\nwill continue."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"max_uris_per_list"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Default: 20"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"This option limits the maximum number of unique lookups that will be\nsubmitted for each list after the input has been normalized into the\nquery format required for the list."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nAny lookups greater than the limit will be discarded."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"List sections should be named as the zone of the blacklist and can\ncontain the following options:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"At least one of the following must be set for any queries to be run for\nthe blacklist."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"rdns = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Check any rDNS names against the list."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"helo = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Check the EHLO/HELO argument against the list."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"envfrom = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Check the MAIL FROM domain against the list."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"from = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Check the domain portion of the From: header against the list."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"replyto = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Check the domain portion of the Reply-To: header against the list."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"msgid = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Check the RHS of the Message-Id: header against the list."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"body = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Check any URIs found within the body of the message against the list."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The following are optional for each list:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"custom_msg"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"A custom rejection message that will be returned to the SMTP client\nif the list returns a positive result.  If found within the string\n{uri} will be replaced by the URI value looked up and {zone} will\nbe replaced by the blacklist zone name."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"validate"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"A regular expression that will be tested against the first A record\nreturned by the list.  If it does not evaluate to true then the positive\nresult will be discarded.  Example: ^(?!127.0.1.255)127. would check\nthat the IP address returned start with 127. and is not 127.0.1.255"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"bitmask"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"This is optionally used for lists such as "},{"type":"element","tag":"a","props":{"href":"http://www.surbl.org/","rel":["nofollow"]},"children":[{"type":"text","value":"SURBL"}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"http://www.uribl.com/","rel":["nofollow"]},"children":[{"type":"text","value":"URIBL"}]},{"type":"text","value":" that\nreturn bitmask values in the last octet of the returned IP address to\ncombine multiple lists into a single zone.  Using this you may specify\nwhich lists within the zone you want use."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"no_ip_lookups = 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Specifies that no IP addresses should ever be check against this list.\nThis is required for dbl.spamhaus.org."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"strip_to_domain= 1 | true | yes | on | enabled"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Specifies that the list requires hostnames be stripped down to the\ndomain boundaries prior to querying the list.  This is required for\nthe "},{"type":"element","tag":"a","props":{"href":"http://www.surbl.org/","rel":["nofollow"]},"children":[{"type":"text","value":"SURBL"}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"http://www.uribl.com/","rel":["nofollow"]},"children":[{"type":"text","value":"URIBL"}]},{"type":"text","value":" lists."}]}]},{"type":"element","tag":"h2","props":{"id":"other-files"},"children":[{"type":"text","value":"Other files"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"data.uribl.excludes"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"This contains a list of domains that should never be looked up in\nany blacklist as they are known good and will never be listed.\nThis helps to keep useless queries to a minimum."}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"configuration","depth":2,"text":"Configuration"},{"id":"other-files","depth":2,"text":"Other files"}]}},"_type":"markdown","_id":"content:8.plugins:data.uribl.md","_source":"content","_file":"8.plugins/data.uribl.md","_extension":"md"}